-- 21. Rank customers based on total spending.

SELECT 
	customer_id, SUM(payment_value), 
	RANK() OVER(ORDER BY SUM(payment_value) DESC) 
FROM 
	project.olist_orders_dataset t1 
JOIN 
	project.olist_order_payments_dataset t2 
ON 
	t1.order_id = t2.order_id 
GROUP BY 
	customer_id;
