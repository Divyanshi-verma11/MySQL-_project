-- 22. Calculate running total of monthly sales.

SELECT 
	t1.order_id, order_purchase_timestamp, payment_value, 
	SUM(payment_value)
	OVER(PARTITION BY MONTH(order_purchase_timestamp), 
		YEAR(order_purchase_timestamp) 
ORDER BY 
	order_purchase_timestamp
	ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS running_month_sale
FROM 
	project.olist_orders_dataset t1 
JOIN 
	project.olist_order_payments_dataset t2 
ON 
	t1.order_id = t2.order_id 
ORDER BY 
	order_purchase_timestamp;
